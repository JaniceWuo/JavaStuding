### 尚硅谷 韩** java设计模式课程

#### 7/14

#### 设计模式的重要性

设计模式是对软件设计中普遍存在（反复出现）的各种问题所提出的解决方案。

#### 设计模式的目的

代码重用性

可读性

可扩展性

可靠性

使程序呈现高内聚，低耦合。

#### 设计模式的几个原则

单一职责   接口隔离  依赖倒转（倒置）  里氏替换  开闭原则  迪米特法则  合成复用原则

迪米特法则又叫最少知道原则，一个类对自己依赖的类知道的越少越好。

合成复用原则是尽量使用合成/聚合的方式，而不是使用继承。

#### 单例模式

![image-20200714200916029](C:\Users\zhuowei\AppData\Roaming\Typora\typora-user-images\image-20200714200916029.png)

##### 饿汉式（静态常量和静态代码块两种）

##### 懒汉式（线程不安全）  ：

​       如果在多线程下，一个线程进入if(singleton==null)判断句，还没来得及往下执行，此时另一个线程来到这个if语句时也能通过，就会产生多个实例，所以在多线程环境下不要使用这种方式。

##### 懒汉式（线程安全，同步方法）

##### 懒汉式（双重检查）  ：

进行两次if(singleton == null)检查，这样可以保证线程安全，且销量较高，推荐使用。代码如下：

![image-20200714165323525](C:\Users\zhuowei\AppData\Roaming\Typora\typora-user-images\image-20200714165323525.png)



##### 单例模式在jdk应用的源码：java.lang.Runtime就是经典的单例模式。

单例模式保证了系统内存中该类只存在一个对象，节省了系统资源，对于一些需要频繁创建和销毁的对象，使用单例模式可以提高性能。

##### 单例模式使用场景：

需要频繁创建和销毁的对象，创建对象时耗时过多或者耗费资源过多但又经常使用到的对象、工具类对象、频繁访问数据库或者文件的对象（如数据源、session工厂等）

#### 工厂模式

以做披萨为例，有一个Pizza类，里面有prepare等方法，其他的cheezePizza等披萨类来继承它，重写prepare方法。然后又有一个orderPizza类来下订单，里面new 不同的pizza类，调用其prepare、bake等方法来准备不同的披萨。这个orderPizza类可能有很多家饭店会调用。当增加一种pizza时，orderPizza里面也要增加相关的调用代码，这样导致要修改很多代码。

##### 简单工厂模式

简单工厂模式是由一个工厂对象决定创建出哪一种产品类的实例，属于创建型模式。























